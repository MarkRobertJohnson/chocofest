module EnsureChocolateyPackage<$PackageName, $PackageVersion = "">
{
    # PSDsc cChoco::cchocopackageinstaller
    # (
    # Otter_ConfigurationKey: Name,
    # Name: $PackageName,
    # Version: $PackageVersion,
    # Ensure: Present,
    # AutoUpgrade: True
    # );
    # Chocolatey::Ensure-Package
    # (
    # Name: $PackageName,
    # Version: $PackageVersion,
    # Source: $ChocolateyFeedUrl
    # );
    PSEnsure
    (
        Key: Chocolatey package: $PackageName|$PackageVersion,
        Value: $PackageName|$PackageVersion,
        Collect: c:\ProgramData\Chocolatey\choco.exe list --limit-output --by-id-only -lo --version=$PackageVersion --exact "$PackageName",
        Configure: >>
            c:\ProgramData\Chocolatey\choco.exe upgrade $Packagename --version=$PackageVersion -y -s $ChocolateyFeedUrl --no-progress --force
            if($LASTEXITCODE) {throw "Error installing $PackageName|$PackageVersion"}
            >>,
        UseExitCode: false
    );
}
